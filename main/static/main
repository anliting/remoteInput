<!doctype html>
<title>Remote Input</title>
<body>
<script type=module>
import{dom}from'https://gitcdn.link/cdn/anliting/simple.js/55124630741399dd0fcbee2f0396642a428cdd24/src/simple.static.js'
function get(path){
    let rq=new XMLHttpRequest
    rq.open('GET',path)
    rq.send()
    return new Promise(rs=>
        rq.onreadystatechange=()=>
            rq.readyState==4&&rq.status==200&&rs(rq.responseText)
    )
}
let
    composing=0,
    input
function checkValue(){
    if(composing)
        return
    let value=input.value
    input.value=''
    get(`/api/${JSON.stringify(['in',value])}`)
}
dom.head(
    dom.style(`
        html{
            height:100%;
        }
        body{
            margin:0;
            height:100%;
        }
        body>input{
            border:unset;
            padding:unset;
            width:0;
        }
    `)
)
dom.body(
    {
        onclick(){
            input.focus()
        }
    },
    input=dom.input(n=>{
        n.addEventListener('compositionstart',e=>{
            composing=1
        })
        n.addEventListener('compositionend',e=>{
            composing=0
            checkValue()
        })
        n.addEventListener('input',e=>{
            checkValue()
        })
    }),
)
input.focus()
window.ui={
    async out(){
        console.log(await get(`/api/${encodeURIComponent(JSON.stringify(['out']))}`))
    }
}
</script>
